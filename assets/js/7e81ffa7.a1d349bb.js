"use strict";(self.webpackChunkfiber_website=self.webpackChunkfiber_website||[]).push([[557],{3905:(e,t,n)=>{n.d(t,{Zo:()=>s,kt:()=>f});var r=n(7294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function p(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var l=r.createContext({}),c=function(e){var t=r.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},s=function(e){var t=c(e.components);return r.createElement(l.Provider,{value:t},e.children)},u={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},d=r.forwardRef((function(e,t){var n=e.components,o=e.mdxType,a=e.originalType,l=e.parentName,s=p(e,["components","mdxType","originalType","parentName"]),d=c(n),f=o,m=d["".concat(l,".").concat(f)]||d[f]||u[f]||a;return n?r.createElement(m,i(i({ref:t},s),{},{components:n})):r.createElement(m,i({ref:t},s))}));function f(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var a=n.length,i=new Array(a);i[0]=d;var p={};for(var l in t)hasOwnProperty.call(t,l)&&(p[l]=t[l]);p.originalType=e,p.mdxType="string"==typeof e?e:o,i[1]=p;for(var c=2;c<a;c++)i[c]=n[c];return r.createElement.apply(null,i)}return r.createElement.apply(null,n)}d.displayName="MDXCreateElement"},3307:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>i,default:()=>u,frontMatter:()=>a,metadata:()=>p,toc:()=>c});var r=n(7462),o=(n(7294),n(3905));const a={sidebar_position:6,title:"Mempool Injector"},i=void 0,p={unversionedId:"usage/fiber-inject",id:"usage/fiber-inject",title:"Mempool Injector",description:"Often, it's very useful to inject transactions from Fiber into your local mempool. We offer a Docker image that will help you do that.",source:"@site/docs/usage/fiber-inject.md",sourceDirName:"usage",slug:"/usage/fiber-inject",permalink:"/docs/usage/fiber-inject",draft:!1,editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/usage/fiber-inject.md",tags:[],version:"current",sidebarPosition:6,frontMatter:{sidebar_position:6,title:"Mempool Injector"},sidebar:"tutorialSidebar",previous:{title:"Tracing",permalink:"/docs/usage/tracing"},next:{title:"Regions",permalink:"/docs/regions"}},l={},c=[{value:"Usage",id:"usage",level:2}],s={toc:c};function u(e){let{components:t,...n}=e;return(0,o.kt)("wrapper",(0,r.Z)({},s,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("p",null,"Often, it's very useful to inject transactions from Fiber into your local mempool. We offer a Docker image that will help you do that."),(0,o.kt)("h2",{id:"usage"},"Usage"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"docker run -p 8080:8080 --name fiber-inject mempirate/fiber-inject \\\n    fiber-inject \\\n    --fiber-api fiberapi.io:8080 \\\n    --fiber-key $YOUR_API_KEY \\\n    --enodes $ENODE1,$ENODE2 \\\n    --port 8080\n")),(0,o.kt)("p",null,"This will proxy the gRPC API on ",(0,o.kt)("inlineCode",{parentName:"p"},"localhost:8080"),", and once (",(0,o.kt)("strong",{parentName:"p"},"and only once"),") you subscribe to the transaction stream, ",(0,o.kt)("inlineCode",{parentName:"p"},"fiber-inject")," will send these\ntransactions to your local node over devp2p."),(0,o.kt)("admonition",{type:"danger"},(0,o.kt)("p",{parentName:"admonition"},"For this to work, you HAVE to connect your client to ",(0,o.kt)("inlineCode",{parentName:"p"},"localhost:8080")," instead of ",(0,o.kt)("inlineCode",{parentName:"p"},"fiberapi.io:8080"),".")),(0,o.kt)("p",null,"Your local ",(0,o.kt)("inlineCode",{parentName:"p"},"enode"),"'s IP address should either be the gateway address of your Docker network (usually ",(0,o.kt)("inlineCode",{parentName:"p"},"172.17.0.1"),"), or one of the publicly reachable\nIP addresses of your machine."),(0,o.kt)("p",null,"It's possible that your local node has reached its maximum amount of peers, and therefore won't accept Fiber inject as another peer.\nIf the Docker container doesn't print the following (",(0,o.kt)("inlineCode",{parentName:"p"},"docker logs fiber-inject"),"):"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"14:51:44.831 INF [DEVP2P] Connected to trusted peer           enode=...\n")),(0,o.kt)("p",null,"that's probably the case, and you have to add ",(0,o.kt)("inlineCode",{parentName:"p"},"fiber-inject")," as a trusted peer. First we need to expose the p2p port of the Docker container, so you'll have to\nrun it like this:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"docker run -p 8080:8080 -p 30304:30303 --name fiber-inject mempirate/fiber-inject \\\n    fiber-inject \\\n    --fiber-api fiberapi.io:8080 \\\n    --fiber-key $YOUR_API_KEY \\\n    --enodes $ENODE1,$ENODE2 \\\n    --port 8080\n")),(0,o.kt)("admonition",{type:"info"},(0,o.kt)("p",{parentName:"admonition"},"Make sure the mapped port isn't already taken by your local node.")),(0,o.kt)("p",null,"Next, find the ",(0,o.kt)("inlineCode",{parentName:"p"},"enode"),". This should also be printed in the output:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre"},"14:51:44.811 INF [DEVP2P] Starting devp2p server               enode=enode://6e45ab02bc08b03da9527ef42e07e12d144eea3365b102b3d7f3b7a3f4ae0aed24a039d346af3a7e0e3c84257458af076e55e8860e262f551dab9d4e472f0fe3@127.0.0.1:30303?discport=0\n")),(0,o.kt)("p",null,"Now add this enode to your local node's trusted peerset, but make sure you use your mapped port as the ",(0,o.kt)("inlineCode",{parentName:"p"},"enode")," port.\nIf you're using geth, you can use the JavaScript console:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"geth attach --datadir $DATADIR --exec \\\n'admin.addTrustedPeer(\"enode://6e45ab02bc08b03da9527ef42e07e12d144eea3365b102b3d7f3b7a3f4ae0aed24a039d346af3a7e0e3c84257458af076e55e8860e262f551dab9d4e472f0fe3@127.0.0.1:30304\")'\n")),(0,o.kt)("p",null,"Now if you check the output, the connection should have been made."))}u.isMDXComponent=!0}}]);